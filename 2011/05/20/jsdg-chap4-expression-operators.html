
<!DOCTYPE html>
<!--[if IE 7 ]>    <html lang="zh-CN" class="ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="zh-CN" class="ie8"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--> <html lang="zh-CN"> <!--<![endif]-->
  <head>
	  <meta charset="utf-8">
	  <!--[if IE 8 ]><meta http-equiv="X-UA-Compatible" content="IE=7"><![endif]-->
	  <title>BW编程之js表达式、运算符篇(五)</title>
	<meta name="keywords" content="张华宁,javascript,js">
    <meta name="description" content="javascript表达式、运算符">
    <meta name="author" content="张华宁">

    <!-- Enable responsive viewport -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Favicon -->
	<link rel="shortcut icon" href="/favicon.ico">

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

	<!-- Styles 
	<link rel="stylesheet" href="/assets/themes/twitter/css/style.min.css">
	<link rel="stylesheet" href="/assets/themes/twitter/css/font-awesome.min.css">
	-->
	<!-- le Styles -->
	<link rel="stylesheet" href="/assets/themes/twitter/bootstrap/css/bootstrap.2.2.2.min.css">
	<link rel="stylesheet" href="/assets/themes/twitter/css/style.css?body=1">

	<!-- Scripts -->
	<script type="text/javascript" src="/assets/themes/twitter/js/jquery-1.10.1.min.js"></script>

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
	<script src="/assets/themes/twitter/js/html5shiv.js"></script>
    <![endif]-->

  </head>

  <body>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-narrow">
          <a class="brand" href="/">张华宁的笔记本</a>
          <ul class="nav">
           <!-- 
            
            


  
    
      
      	
      	<li><a href="/tags.html">标签</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/about.html">关于我</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/archive.html">归档</a></li>
      	
      
    
  


 -->
            <li><a href="/index.html">首页</a></li>
            <li><a href="/archive.html">归档</a></li>
            <li><a href="/tags.html">标签</a></li>
            <li><a href="/about.html">关于我</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="container-narrow">

      <div class="content">
        
<div class="page-header">
  <h1>BW编程之js表达式、运算符篇(五) </h1>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="date">
      <span>20 May 2011</span>
    </div>
    <div class="content">
      <h4 id="whitejs">White:js中什么是表达式和运算符？</h4>

<p><em>Black:</em>在js中表达式（expression）是一个短语，js解释器会将其计算出一个结果。程序中的常量是最简单的一类表达式。变量名也是一种简单表达式，它的值就是赋值给变量的值。复杂表达式是由简单表达式组成的，常用的方法是使用运算符(operator)。运算符按照特定的运算规则对操作数进行运算，并计算出新值。</p>

<p>表达式主要包含原始表达式(直接量(常量)、关键字(true,false，null,this)、变量），对象和数组初始化表达式（<code>var p = {x:2, y:3}</code>、<code>var days = [1,2,3]</code>） ，函数定义表达式（<code>var sum = function(a,b) {return a + b}</code>)，属性访问表达式(<code>p.x</code>、<code>p[&quot;y&quot;]</code>、<code>days[0]</code>），调用表达式（调用函数或方法的语法表示），对象创建表达式(new)，运算表达式（见下面运算符所示）等。</p>

<p>js中的运算符主要用于算术表达式(+、-、*、/)、比较表达式(&lt;、===、&gt;）、逻辑表达式（&amp;&amp;、||、！）、赋值表达式（=）等。大多数运算符都用标点符号表示，比如+-*/，也有一些运算符用关键字表示，比如delete、instanceof、typeof、void等。运算符是有优先级和结合性(一元操作符、赋值、三元条件运算符都是右结合)的，关于运算符可参见下图：</p>

<p><img src="/assets/themes/twitter/img/operator1.png" alt="" title="运算符汇总1" /></p>

<p><img src="/assets/themes/twitter/img/operator2.png" alt="" title="运算符汇总2" /></p>
<hr />
<h4 id="white">White:什么是左值,什么是表达式副作用？</h4>

<p><em>Black:</em>左值是一个术语，它指“表达式只能出现在运算符的左侧”。在js中变量、对象属性、数组元素均是左值。ECMAScript规范允许内置函数返回左值，但是自定义函数不能返回左值。</p>

<p>表达式副作用是指本来计算表达式（比如<code>2*3</code>)不会对程序的运行状态造成任何影响，程序后续的计算也不会受到该表达式运算的影响，但是有一些表达式在即算后会产生上述影响，这就是表达式的副作用。</p>

<p>会产生副作用的表达式有：赋值、自增、函数调用、对象创建、delete等。</p>
<hr />
<h4 id="white_2">White:调用表达式怎么理解？</h4>

<p><em>Black:</em>调用表达式(invocation expression）是一种调用（或者执行）函数或方法的语法表示。当调用表达式进行求值的时候，首先计算函数表达式，然后计算参数表达式，得到一组参数。然后实参的值被依次传递给形参，这些形参是定义函数时指定的，接下来执行函数体。执行后返回该函数的返回值，如果没有则返回undefined。</p>

<p>在js中函数调用有两种方式普通调用和new调用，这两种方式调用同一个函数，其意义确实差异巨大。普通方式是通过func.apply方式来对函数过程进行调用，而new方式是对象创建表达式，详细见下面的new关键字的理解。</p>

<p>函数表达式本身可以说没有副作用，但是因为函数体内部的语句或者表达式可能会产生副作用，所以这种情况下一般说函数表达式是有副作用的。</p>
<hr />
<h4 id="whitenew">White:对象创建表达式和new关键字怎么理解？</h4>

<p><em>Black:</em>对象创建表达式(object creation expression)创建一个对象并调用一个函数(这个函数称作构造函数)初始化对象的属性。js通过new关键字来进行对象创建，new关键字调用的函数与普通调用方式有2点不同：改变了上下文和改变了返回值。</p>

<p><strong><em>new的本质</em></strong>，new关键字本质上也是调用函数的方式（普通函数调用是通过func.apply或func.call方式调用），它的特殊性在于把函数当作构造函数来执行，并最终创建一个对象。其过程如下：js解释器new关键字时知道是创建对象的时候了，进行了如下步骤：</p>

<ul>
<li>首先传见一个新的空对象（{}）。</li>

<li>然后把这个对象赋值给this（自定义函数无法给this赋值）。</li>

<li>构造函数的prototype作为新对象的原型(__proto___)。</li>

<li>把构造函数作为新对象的原型(__proto__)的constructor。</li>

<li>调用构造函数把传入的参数和构造函数中赋值给this的属性都作为新对象的属性</li>

<li>如果构造函数没有return则把这个构造好新对象作为返回值。</li>

<li>如果有return则把其返回的对象作为最后的返回值，即创建表达式计算的值。</li>
</ul>
<hr />
<h4 id="white_3">White:比较运算符中的==和===的区别是什么？</h4>

<p><em>Black:</em>简单来说==会进行类型转换后比较，而===不进行类型转换直接比较，===也是严格比较,应该只使用===。</p>

<p>===规则为：</p>

<ul>
<li>如果两个值类型不同，则它们不相等。</li>

<li>如果两个值都是null或者undefined，则它们不相等。</li>

<li>如果两个值都是true或者都是false，则相等。</li>

<li>任何一个是NaN则不相等，NaN需要使用!==来判断。</li>

<li>如果两个值为数字且数值相等，则相等。0和-0相等。</li>

<li>两个字符串只有它们所对应存储的16位数字完全相等，则它们相等。（字符串实际上是16位整数数值组成的序列，同一字符串但编码不同就是2个不同的整数序列，所以不相等。）</li>

<li>如果两个引用值指向同一个对象、数组或者函数，则相等，只比较引用不考虑具体的值的情况。</li>
</ul>

<p>==规则就是===规则然后每一个都允许进行类型转换后尝试比较，比如<code>null==undefined //=&gt;true</code>。</p>

<p>对象转换原始值是除了日期先进行toString，其他都是先valueof后调用toString进行转换。</p>
<hr />
<h4 id="white_4">White:对象转换为原始值有哪些规则？</h4>

<p><em>Black:</em>所有对象都继承了2个转换方法，第一个是toString（），它的作用是返回一个反映对象的字符串，默认是<code>[object Object]</code>,我们可以通过Object.prototype.toString.call(o)来得到o的实际类型，比如<code>[object String]</code>。</p>

<p>第二个是valueof()，如果存在任意原始值，它就默认将对象转换未它的原始值。但是大多数对象无法真正表示为一个原始值，因此默认的valueof简单返回对象本身，而不是一个原始值。</p>

<p>对象到字符串的转换步骤（先toString后valueof）：</p>

<pre><code>	if(o.has_method(toString) &amp;&amp; o.toString()===&quot;原始值&quot;)
	{
		return o.toString().转成字符串;
	} else if(o.has_method(valueof) &amp;&amp; o.valueof() === &quot;原始值&quot;)
	{
		return o.valueof().转成字符串；
	} else
	{
		throw 异常；
	}</code></pre>

<p>对象到数字的转换步骤（先valueof后toString）：</p>

<pre><code>	if(o.has_method(valueof) &amp;&amp; o.valueof() === &quot;原始值&quot;)
	{
		return o.valueof().转成数字；
	} else if(o.has_method(toString) &amp;&amp; o.toString()===&quot;原始值&quot;)
	{
		return o.toString().数字;
	} else
	{
		throw 异常；
	}</code></pre>

<p>对象转换原始值是除了日期先进行toString，其他都是先valueof后调用toString进行转换。</p>
<hr />
    </div>

    

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
     
    	<li><a href="/tags.html#javascript-ref">javascript <span>25</span></a></li>
     
    	<li><a href="/tags.html#js权威指南-ref">js权威指南 <span>25</span></a></li>
    
  



    </ul>
    

    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/2011/05/15/jsdg-chap3-types-values-variables3.html" title="BW编程之js变量篇作用域链(四)">&larr; Previous</a></li>
      
        <li><a href="/archive.html">Archive</a></li>
      
        <li class="next"><a href="/2011/05/25/jsdg-chap4-expression-operators2.html" title="BW编程之js表达式篇eval(六)">Next &rarr;</a></li>
      
      </ul>
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'izhanghuaning'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  </div>
</div>


      </div>
	  <hr>
      <footer>
        <p>&copy;2011-2014 张华宁
          基于 <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          和 <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a> 搭建,
		  <em><strong>本博客的很多想法来自于其他优秀博客作者，时隔久远不能给出每个链接了，如果原作者觉得被冒犯，请留言或联系我（izhanghuaning$163.com），我会及时进行处理，衷心感谢你们，本博客内容和源代码遵循<a href="http://opensource.org/licenses/mit-license.php" target="_blank">MIT开源协议</a>,转载请注明出处，谢谢。</strong></em>
        </p>
      </footer>

    </div>

    
  </body>
</html>

